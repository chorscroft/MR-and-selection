require(systemfit)
################################################################
## Basic simulation, 0.05(0.01)
################################################################
setwd("~/Bristol/Simulations/children")
dat<-read.table("output.txt",header = TRUE)
sf<-systemfit(fit~pheno,inst = ~geno,method = "2SLS",data=dat)
summary(sf)
## take a random sample of 100 geno==0 and 100 geno==1
dat_samp<-dat[c(sample(which(dat$geno==0),100,replace = FALSE),sample(which(dat$geno==1),100,replace = FALSE)),]
sf_samp<-systemfit(fit~pheno,inst = ~geno,method = "2SLS",data=dat_samp)
summary(sf_samp)
par<-read.table("parent.txt",header = TRUE)
View(par)
sapply(dat$index,function(x) sum(par$parent1==x | par$parent2==x))
dat$children<-sapply(dat$index,function(x) sum(par$parent1==x | par$parent2==x))
View(dat)
sf<-systemfit(children~pheno,inst = ~geno,method = "2SLS",data=dat)
summary(sf)
dat$childrenOE<-dat$children/2
sf<-systemfit(childrenOE~pheno,inst = ~geno,method = "2SLS",data=dat)
summary(sf)
## take a random sample of 100 geno==0 and 100 geno==1
dat_samp<-dat[c(sample(which(dat$geno==0),100,replace = FALSE),sample(which(dat$geno==1),100,replace = FALSE)),]
sf_samp_children<-systemfit(children~pheno,inst = ~geno,method = "2SLS",data=dat_samp)
summary(sf_samp_children)
sf_samp_children<-systemfit(childrenOE~pheno,inst = ~geno,method = "2SLS",data=dat_samp)
summary(sf_samp_children)
sf_children<-systemfit(childrenOE~pheno,inst = ~geno,method = "2SLS",data=dat)
summary(sf_children)
## take a random sample of 100 geno==0 and 100 geno==1
dat_samp<-dat[c(sample(which(dat$geno==0),100,replace = FALSE),sample(which(dat$geno==1),100,replace = FALSE)),]
sf_samp_children<-systemfit(childrenOE~pheno,inst = ~geno,method = "2SLS",data=dat_samp)
summary(sf_samp_children)
## take a random sample of 100 geno==0 and 100 geno==1
dat_samp<-dat[c(sample(which(dat$geno==0),100,replace = FALSE),sample(which(dat$geno==1),100,replace = FALSE)),]
sf_samp_children<-systemfit(childrenOE~pheno,inst = ~geno,method = "2SLS",data=dat_samp)
summary(sf_samp_children)
## take a random sample of 100 geno==0 and 100 geno==1
dat_samp<-dat[c(sample(which(dat$geno==0),100,replace = FALSE),sample(which(dat$geno==1),100,replace = FALSE)),]
sf_samp_children<-systemfit(childrenOE~pheno,inst = ~geno,method = "2SLS",data=dat_samp)
summary(sf_samp_children)
dat$childrenOE<-dat$children/2-1
sf_children<-systemfit(childrenOE~pheno -1,inst = ~geno,method = "2SLS",data=dat)
summary(sf_children)
sf_children<-systemfit(childrenOE~pheno -1,inst = ~geno,method = "2SLS",data=dat)
summary(sf_children)
## take a random sample of 100 geno==0 and 100 geno==1
dat_samp<-dat[c(sample(which(dat$geno==0),100,replace = FALSE),sample(which(dat$geno==1),100,replace = FALSE)),]
sf_samp_children<-systemfit(childrenOE~pheno,inst = ~geno,method = "2SLS",data=dat_samp)
summary(sf_samp_children)
sf_samp_children<-systemfit(childrenOE~pheno-1,inst = ~geno,method = "2SLS",data=dat_samp)
summary(sf_samp_children)
## take a random sample of 100 geno==0 and 100 geno==1
dat_samp<-dat[c(sample(which(dat$geno==0),100,replace = FALSE),sample(which(dat$geno==1),100,replace = FALSE)),]
sf_samp_children<-systemfit(childrenOE~pheno-1,inst = ~geno,method = "2SLS",data=dat_samp)
summary(sf_samp_children)
## take a random sample of 100 geno==0 and 100 geno==1
dat_samp<-dat[c(sample(which(dat$geno==0),100,replace = FALSE),sample(which(dat$geno==1),100,replace = FALSE)),]
sf_samp_children<-systemfit(childrenOE~pheno-1,inst = ~geno,method = "2SLS",data=dat_samp)
summary(sf_samp_children)
sf_children<-systemfit(childrenOE~pheno -1,inst = ~geno,method = "2SLS",data=dat)
summary(sf_children)
dat<-read.table("output.txt",header = TRUE)
par<-read.table("parent.txt",header = TRUE)
dat$children<-sapply(dat$index,function(x) sum(par$parent1==x | par$parent2==x))
dat$childrenOE<-dat$children/2-1
sf<-systemfit(fit~pheno,inst = ~geno,method = "2SLS",data=dat)
summary(sf)
sf_children<-systemfit(childrenOE~pheno -1,inst = ~geno,method = "2SLS",data=dat)
summary(sf_children)
sf_children<-systemfit(childrenOE~pheno,inst = ~geno,method = "2SLS",data=dat)
summary(sf_children)
## take a random sample of 100 geno==0 and 100 geno==1
dat_samp<-dat[c(sample(which(dat$geno==0),100,replace = FALSE),sample(which(dat$geno==1),100,replace = FALSE)),]
sf_samp_children<-systemfit(childrenOE~pheno,inst = ~geno,method = "2SLS",data=dat_samp)
summary(sf_samp_children)
## take a random sample of 100 geno==0 and 100 geno==1
dat_samp<-dat[c(sample(which(dat$geno==0),100,replace = FALSE),sample(which(dat$geno==1),100,replace = FALSE)),]
sf_samp_children<-systemfit(childrenOE~pheno,inst = ~geno,method = "2SLS",data=dat_samp)
summary(sf_samp_children)
## take a random sample of 100 geno==0 and 100 geno==1
dat_samp<-dat[c(sample(which(dat$geno==0),100,replace = FALSE),sample(which(dat$geno==1),100,replace = FALSE)),]
sf_samp_children<-systemfit(childrenOE~pheno,inst = ~geno,method = "2SLS",data=dat_samp)
summary(sf_samp_children)
## take a random sample of 100 geno==0 and 100 geno==1
dat_samp<-dat[c(sample(which(dat$geno==0),100,replace = FALSE),sample(which(dat$geno==1),100,replace = FALSE)),]
sf_samp_children<-systemfit(childrenOE~pheno,inst = ~geno,method = "2SLS",data=dat_samp)
summary(sf_samp_children)
## take a random sample of 100 geno==0 and 100 geno==1
dat_samp<-dat[c(sample(which(dat$geno==0),100,replace = FALSE),sample(which(dat$geno==1),100,replace = FALSE)),]
sf_samp_children<-systemfit(childrenOE~pheno,inst = ~geno,method = "2SLS",data=dat_samp)
summary(sf_samp_children)
sf_children<-systemfit(childrenOE~pheno,inst = ~geno,method = "2SLS",data=dat)
summary(sf_children)
sf_children<-systemfit(childrenOE~pheno,inst = ~geno,method = "2SLS",data=dat)
summary(sf_children)
sf<-systemfit(fit~pheno,inst = ~geno,method = "2SLS",data=dat)
summary(sf)
plot(pheno,childrenOE,data=dat)
plot(dat$pheno,dat$childrenOE)
mean(dat$childrenOE)
dat$childrenOE<-dat$children/2
mean(dat$childrenOE)
plot(dat$pheno,dat$childrenOE)
sf_children<-systemfit(childrenOE~pheno,inst = ~geno,method = "2SLS",data=dat)
summary(sf_children)
## take a random sample of 100 geno==0 and 100 geno==1
dat_samp<-dat[c(sample(which(dat$geno==0),100,replace = FALSE),sample(which(dat$geno==1),100,replace = FALSE)),]
sf_samp_children<-systemfit(childrenOE~pheno,inst = ~geno,method = "2SLS",data=dat_samp)
summary(sf_samp_children)
boxplot(dat$geno,dat$childrenOE)
boxplot(dat$geno,dat$children)
boxplot(dat$geno,dat$childrenOE)
boxplot(dat_samp$geno,dat_samp$childrenOE)
## take a random sample of 100 geno==0 and 100 geno==1
dat_samp<-dat[c(sample(which(dat$geno==0),100,replace = FALSE),sample(which(dat$geno==1),100,replace = FALSE)),]
sf_samp_children<-systemfit(childrenOE~pheno,inst = ~geno,method = "2SLS",data=dat_samp)
summary(sf_samp_children)
boxplot(dat_samp$geno,dat_samp$childrenOE)
## take a random sample of 100 geno==0 and 100 geno==1
dat_samp<-dat[c(sample(which(dat$geno==0),100,replace = FALSE),sample(which(dat$geno==1),100,replace = FALSE)),]
sf_samp_children<-systemfit(childrenOE~pheno,inst = ~geno,method = "2SLS",data=dat_samp)
summary(sf_samp_children)
boxplot(dat_samp$geno,dat_samp$childrenOE)
hist(dat$children)
hist(dat$children,breaks=seq(0,max(dat$children)))
hist(dat$children[dat$geno==0],col=c1,breaks=seq(0,max(dat$children))
)
c1 <- rgb(173,216,230,max = 255, alpha = 80, names = "lt.blue")
c2 <- rgb(255,192,203, max = 255, alpha = 80, names = "lt.pink")
hist(dat$children[dat$geno==0],col=c1,breaks=seq(0,max(dat$children)))
hist(dat$children[dat$geno==1],col=c2,breaks=seq(0,max(dat$children)),add=TRUE)
dat$children[dat$geno==0]
boxplot(dat$geno,dat$children)
boxplot(dat$children~dat$geno)
boxplot(dat_samp$childrenOE~dat_samp$geno)
hist(dat$children[dat$geno==0],col=c1,breaks=seq(0,max(dat$children)))
hist(dat$children[dat$geno==1],col=c2,breaks=seq(0,max(dat$children)),add=TRUE)
dat$childrenOE<-dat$children/2
hist(dat$childrenOE[dat$geno==0],col=c1,breaks=seq(0,max(dat$childrenOE),0.5))
hist(dat$childrenOE[dat$geno==1],col=c2,breaks=seq(0,max(dat$childrenOE),0.5),add=TRUE)
sf<-systemfit(fit~pheno,inst = ~geno,method = "2SLS",data=dat)
summary(sf)
sf_children<-systemfit(childrenOE~pheno,inst = ~geno,method = "2SLS",data=dat)
summary(sf_children)
0.3547081+1.96*0.013940650
0.03547081+1.96*0.013940650
0.98207139+1.96*0.00998909
require(systemfit)
################################################################
## Basic simulation, 0.05(0.01)
################################################################
setwd("~/Bristol/Simulations/basic")
dat<-read.table("output.txt",header = TRUE)
sf<-systemfit(fit~pheno,inst = ~geno,method = "2SLS",data=dat)
summary(sf)
View(dat)
setwd("~/Bristol/Simulations/two_pheno/")
dat2<-read.table("output.txt",header = TRUE)
sf1<-systemfit(fit~pheno1,inst = ~geno,method = "2SLS",data=dat2)
summary(sf1)
sf2<-systemfit(fit~pheno2,inst = ~geno,method = "2SLS",data=dat2)
summary(sf2)
sf1<-systemfit(fit~pheno1+pheno2,inst = ~geno,method = "2SLS",data=dat2)
summary(sf1)
################################################################
## Basic simulation, 0.05(0.01)
################################################################
setwd("~/Bristol/Simulations/children")
dat<-read.table("output.txt",header = TRUE)
par<-read.table("parent.txt",header = TRUE)
dat$children<-sapply(dat$index,function(x) sum(par$parent1==x | par$parent2==x))
dat$childrenOE<-dat$children/2
sf<-systemfit(fit~pheno,inst = ~geno,method = "2SLS",data=dat)
summary(sf)
sf_children<-systemfit(childrenOE~pheno,inst = ~geno,method = "2SLS",data=dat)
summary(sf_children)
